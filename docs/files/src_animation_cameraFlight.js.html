<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/animation/cameraFlight.js - xeoengine</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">

                <h1 style="color:white;"><a href="../../">xeoEngine</a> / <a href="../../docs">API Docs</a></h1>

        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AmbientLight.html">AmbientLight</a></li>
                                <li><a href="../classes/Billboard.html">Billboard</a></li>
                                <li><a href="../classes/Boundary2D.html">Boundary2D</a></li>
                                <li><a href="../classes/Boundary3D.html">Boundary3D</a></li>
                                <li><a href="../classes/BoundaryGeometry.html">BoundaryGeometry</a></li>
                                <li><a href="../classes/BoxGeometry.html">BoxGeometry</a></li>
                                <li><a href="../classes/Camera.html">Camera</a></li>
                                <li><a href="../classes/CameraControl.html">CameraControl</a></li>
                                <li><a href="../classes/CameraController.html">CameraController</a></li>
                                <li><a href="../classes/CameraFlight.html">CameraFlight</a></li>
                                <li><a href="../classes/Canvas.html">Canvas</a></li>
                                <li><a href="../classes/Cardboard.html">Cardboard</a></li>
                                <li><a href="../classes/Clip.html">Clip</a></li>
                                <li><a href="../classes/Clips.html">Clips</a></li>
                                <li><a href="../classes/Collection.html">Collection</a></li>
                                <li><a href="../classes/CollectionBoundary.html">CollectionBoundary</a></li>
                                <li><a href="../classes/ColorBuf.html">ColorBuf</a></li>
                                <li><a href="../classes/ColorTarget.html">ColorTarget</a></li>
                                <li><a href="../classes/Component.html">Component</a></li>
                                <li><a href="../classes/Configs.html">Configs</a></li>
                                <li><a href="../classes/CubicBezierCurve.html">CubicBezierCurve</a></li>
                                <li><a href="../classes/Cull.html">Cull</a></li>
                                <li><a href="../classes/Curve.html">Curve</a></li>
                                <li><a href="../classes/CylinderGeometry.html">CylinderGeometry</a></li>
                                <li><a href="../classes/DepthBuf.html">DepthBuf</a></li>
                                <li><a href="../classes/DepthTarget.html">DepthTarget</a></li>
                                <li><a href="../classes/DirLight.html">DirLight</a></li>
                                <li><a href="../classes/Entity.html">Entity</a></li>
                                <li><a href="../classes/Fresnel.html">Fresnel</a></li>
                                <li><a href="../classes/Frustum.html">Frustum</a></li>
                                <li><a href="../classes/Geometry.html">Geometry</a></li>
                                <li><a href="../classes/HeightmapGeometry.html">HeightmapGeometry</a></li>
                                <li><a href="../classes/Input.html">Input</a></li>
                                <li><a href="../classes/KeyboardAxisCamera.html">KeyboardAxisCamera</a></li>
                                <li><a href="../classes/KeyboardPanCamera.html">KeyboardPanCamera</a></li>
                                <li><a href="../classes/KeyboardRotateCamera.html">KeyboardRotateCamera</a></li>
                                <li><a href="../classes/KeyboardZoomCamera.html">KeyboardZoomCamera</a></li>
                                <li><a href="../classes/LatheGeometry.html">LatheGeometry</a></li>
                                <li><a href="../classes/Layer.html">Layer</a></li>
                                <li><a href="../classes/Lights.html">Lights</a></li>
                                <li><a href="../classes/Lookat.html">Lookat</a></li>
                                <li><a href="../classes/Material.html">Material</a></li>
                                <li><a href="../classes/MegaTexture.html">MegaTexture</a></li>
                                <li><a href="../classes/Model.html">Model</a></li>
                                <li><a href="../classes/Modes.html">Modes</a></li>
                                <li><a href="../classes/MorphTargets.html">MorphTargets</a></li>
                                <li><a href="../classes/MousePanCamera.html">MousePanCamera</a></li>
                                <li><a href="../classes/MousePickEntity.html">MousePickEntity</a></li>
                                <li><a href="../classes/MouseRotateCamera.html">MouseRotateCamera</a></li>
                                <li><a href="../classes/MouseZoomCamera.html">MouseZoomCamera</a></li>
                                <li><a href="../classes/Nintendo3DSGeometry.html">Nintendo3DSGeometry</a></li>
                                <li><a href="../classes/OBJGeometry.html">OBJGeometry</a></li>
                                <li><a href="../classes/Ortho.html">Ortho</a></li>
                                <li><a href="../classes/Path.html">Path</a></li>
                                <li><a href="../classes/PathGeometry.html">PathGeometry</a></li>
                                <li><a href="../classes/Perspective.html">Perspective</a></li>
                                <li><a href="../classes/PhongMaterial.html">PhongMaterial</a></li>
                                <li><a href="../classes/PlaneGeometry.html">PlaneGeometry</a></li>
                                <li><a href="../classes/PointLight.html">PointLight</a></li>
                                <li><a href="../classes/QuadraticBezierCurve.html">QuadraticBezierCurve</a></li>
                                <li><a href="../classes/Quaternion.html">Quaternion</a></li>
                                <li><a href="../classes/Reflect.html">Reflect</a></li>
                                <li><a href="../classes/Render.html">Render</a></li>
                                <li><a href="../classes/Rotate.html">Rotate</a></li>
                                <li><a href="../classes/Scale.html">Scale</a></li>
                                <li><a href="../classes/Scene.html">Scene</a></li>
                                <li><a href="../classes/Shader.html">Shader</a></li>
                                <li><a href="../classes/ShaderParams.html">ShaderParams</a></li>
                                <li><a href="../classes/Skybox.html">Skybox</a></li>
                                <li><a href="../classes/SphereGeometry.html">SphereGeometry</a></li>
                                <li><a href="../classes/Spinner.html">Spinner</a></li>
                                <li><a href="../classes/SplineCurve.html">SplineCurve</a></li>
                                <li><a href="../classes/Stage.html">Stage</a></li>
                                <li><a href="../classes/Stationary.html">Stationary</a></li>
                                <li><a href="../classes/TeapotGeometry.html">TeapotGeometry</a></li>
                                <li><a href="../classes/Texture.html">Texture</a></li>
                                <li><a href="../classes/TorusGeometry.html">TorusGeometry</a></li>
                                <li><a href="../classes/Transform.html">Transform</a></li>
                                <li><a href="../classes/Translate.html">Translate</a></li>
                                <li><a href="../classes/VectorTextGeometry.html">VectorTextGeometry</a></li>
                                <li><a href="../classes/Viewport.html">Viewport</a></li>
                                <li><a href="../classes/Visibility.html">Visibility</a></li>
                                <li><a href="../classes/WebVR.html">WebVR</a></li>
                                <li><a href="../classes/XEO.html">XEO</a></li>
                                <li><a href="../classes/XEO.math.math.html">XEO.math.math</a></li>
                                <li><a href="../classes/ZSpace.html">ZSpace</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="..//modules/animation.html">animation</a></li>
                                <li><a href="..//modules/boundaries.html">boundaries</a></li>
                                <li><a href="..//modules/camera.html">camera</a></li>
                                <li><a href="..//modules/canvas.html">canvas</a></li>
                                <li><a href="..//modules/clipping.html">clipping</a></li>
                                <li><a href="..//modules/collections.html">collections</a></li>
                                <li><a href="..//modules/configs.html">configs</a></li>
                                <li><a href="..//modules/controls.html">controls</a></li>
                                <li><a href="..//modules/culling.html">culling</a></li>
                                <li><a href="..//modules/curves.html">curves</a></li>
                                <li><a href="..//modules/entities.html">entities</a></li>
                                <li><a href="..//modules/geometry.html">geometry</a></li>
                                <li><a href="..//modules/importing.html">importing</a></li>
                                <li><a href="..//modules/input.html">input</a></li>
                                <li><a href="..//modules/interaction.html">interaction</a></li>
                                <li><a href="..//modules/lighting.html">lighting</a></li>
                                <li><a href="..//modules/materials.html">materials</a></li>
                                <li><a href="..//modules/math.html">math</a></li>
                                <li><a href="..//modules/paths.html">paths</a></li>
                                <li><a href="..//modules/rendering.html">rendering</a></li>
                                <li><a href="..//modules/shaders.html">shaders</a></li>
                                <li><a href="..//modules/skyboxes.html">skyboxes</a></li>
                                <li><a href="..//modules/transforms.html">transforms</a></li>
                                <li><a href="..//modules/webvr.html">webvr</a></li>
                                <li><a href="..//modules/XEO.html">XEO</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <!--<div id="api-options">-->
                    <!--Show:-->
                    <!--<label for="api-show-inherited">-->
                        <!--<input type="checkbox" id="api-show-inherited" checked>-->
                        <!--Inherited-->
                    <!--</label>-->
            
                    <!--<label for="api-show-protected">-->
                        <!--<input type="checkbox" id="api-show-protected">-->
                        <!--Protected-->
                    <!--</label>-->
            
                    <!--<label for="api-show-private">-->
                        <!--<input type="checkbox" id="api-show-private">-->
                        <!--Private-->
                    <!--</label>-->
                    <!--<label for="api-show-deprecated">-->
                        <!--<input type="checkbox" id="api-show-deprecated">-->
                        <!--Deprecated-->
                    <!--</label>-->
            
                <!--</div>-->
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/animation/cameraFlight.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 A **CameraFlight** flies a {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to a given target.

 &lt;ul&gt;
 &lt;li&gt;A CameraFlight animates the {{#crossLink &quot;Lookat&quot;}}{{/crossLink}} attached to its {{#crossLink &quot;Camera&quot;}}{{/crossLink}}.&lt;/li&gt;
 &lt;li&gt;A CameraFlight can be attached to a different {{#crossLink &quot;Camera&quot;}}{{/crossLink}} at any time.&lt;/li&gt;
 &lt;li&gt;While a CameraFlight is busy flying to a target, it can be stopped, or redirected to fly to a different target.&lt;/li&gt;
 &lt;/ul&gt;

 A target can be:

 &lt;ul&gt;
 &lt;li&gt;specific &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60; positions,&lt;/li&gt;
 &lt;li&gt;a World-space {{#crossLink &quot;Boundary3D&quot;}}{{/crossLink}},&lt;/li&gt;
 &lt;li&gt;an instance or ID of any {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that provides a World-space&lt;/li&gt;
 {{#crossLink &quot;Boundary3D&quot;}}{{/crossLink}} in a &quot;worldBoundary&quot; property, or&lt;/li&gt;
 &lt;li&gt;an axis-aligned World-space bounding box.&lt;/li&gt;
 &lt;/ul&gt;

 ## Examples

 &lt;ul&gt;
 &lt;li&gt;[Flying to Entity](../../examples/#animation_CameraFlight_Entity)&lt;/li&gt;
 &lt;li&gt;[Flying to Boundary3D](../../examples/#animation_CameraFlight_Boundary3D)&lt;/li&gt;
 &lt;li&gt;[Flying to AABB](../../examples/#animation_CameraFlight_AABB)&lt;/li&gt;
 &lt;/ul&gt;

 ## Flying to a position

 Flying the CameraFlight from the previous example to specified eye, look and up positions:

 &#x60;&#x60;&#x60;&#x60;Javascript
 cameraFlight.flyTo({
    eye: [-5,-5,-5],
    look: [0,0,0]
    up: [0,1,0]
 }, function() {
    // Arrived
 });
 &#x60;&#x60;&#x60;&#x60;
 ## Flying to an Entity

 Flying to an {{#crossLink &quot;Entity&quot;}}{{/crossLink}} (which provides a World-space
 {{#crossLink &quot;Boundary3D&quot;}}{{/crossLink}} via its {{#crossLink &quot;Entity/worldBoundary:property&quot;}}{{/crossLink}} property):

 &#x60;&#x60;&#x60;&#x60;Javascript
 var camera = new XEO.Camera();

 // Create a CameraFlight that takes exactly twenty seconds to fly
 // the Camera to each specified target
 var cameraFlight = new XEO.CameraFlight({
    camera: camera,
    duration: 20 // Seconds
 });

 // Create a Entity, which gets all the default components
 var entity = new Entity();

 // Fly to the Entity&#x27;s worldBoundary
 cameraFlight.flyTo(entity);
 &#x60;&#x60;&#x60;&#x60;

 ## Flying to a Boundary3D

 Flying the CameraFlight from the previous two examples explicitly to the World-space
 {{#crossLink &quot;Boundary3D&quot;}}{{/crossLink}} of the {{#crossLink &quot;Entity&quot;}}{{/crossLink}} property):

 &#x60;&#x60;&#x60;&#x60;Javascript
 var worldBoundary = entity.worldBoundary;

 cameraFlight.flyTo(worldBoundary);
 &#x60;&#x60;&#x60;&#x60;

 ## Flying to an AABB

 Flying the CameraFlight from the previous two examples explicitly to the {{#crossLink &quot;Boundary3D&quot;}}Boundary3D&#x27;s{{/crossLink}}
 axis-aligned bounding box:

 &#x60;&#x60;&#x60;&#x60;Javascript
 var worldBoundary = entity.worldBoundary;

 var aabb = worldBoundary.aabb;

 cameraFlight.flyTo(aabb);
 &#x60;&#x60;&#x60;&#x60;

 @class CameraFlight
 @author xeolabs / http://xeolabs.org
 @module XEO
 @submodule animation
 @constructor
 @param [scene] {Scene} Parent {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}}.
 @param [cfg] {String|Component|Boundary3D|Array of Number|*} Target - see class documentation above.
 @param [cfg.id] {String} Optional ID, unique among all components in the parent {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}}, generated automatically when omitted.
 @param [cfg.meta] {String:Object} Optional map of user-defined metadata to attach to this CameraFlight.
 @param [cfg.camera] {String|Camera} ID or instance of a {{#crossLink &quot;Camera&quot;}}Camera{{/crossLink}} to control.
 Must be within the same {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}} as this CameraFlight. Defaults to the
 parent {{#crossLink &quot;Scene&quot;}}Scene{{/crossLink}}&#x27;s default instance, {{#crossLink &quot;Scene/camera:property&quot;}}camera{{/crossLink}}.
 @extends Component
 */
(function () {

    &quot;use strict&quot;;

    // Caches to avoid garbage collection

    var tempVec3 = XEO.math.vec3();
    var tempVec3b = XEO.math.vec3();
    var tempVec3c = XEO.math.vec3();

    XEO.CameraFlight = XEO.Component.extend({

        /**
         JavaScript class name for this Component.

         @property type
         @type String
         @final
         */
        type: &quot;XEO.CameraFlight&quot;,

        _init: function (cfg) {

            this._look1 = XEO.math.vec3();
            this._eye1 = XEO.math.vec3();
            this._up1 = XEO.math.vec3();

            this._look2 = XEO.math.vec3();
            this._eye2 = XEO.math.vec3();
            this._up2 = XEO.math.vec3();

            this._flying = false;

            this._callback = null;
            this._callbackScope = null;

            this._onTick = null;

            this._stopFOV = 55;

            this._time1 = null;
            this._time2 = null;

            this.easing = cfg.easing !== false;

            this.duration = cfg.duration || 0.5;

            this.camera = cfg.camera;

            // Shows a wireframe box at the given boundary
            this._boundaryIndicator = this.create(XEO.Entity, {
                geometry: this.create(XEO.BoundaryGeometry, {
                    material: this.create(XEO.PhongMaterial, {
                        diffuse: [0, 0, 0],
                        ambient: [0, 0, 0],
                        specular: [0, 0, 0],
                        emissive: [1.0, 1.0, 0.0],
                        lineWidth: 3
                    })
                }),
                visibility: this.create(XEO.Visibility, {
                    visible: false
                }),
                modes: this.create(XEO.Modes, {
                    collidable: false // Effectively has no boundary
                })
            });
        },

        /**
         * Begins flying this CameraFlight&#x27;s {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to the given target.
         *
         * &lt;ul&gt;
         *     &lt;li&gt;When the target is a boundary, the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} will fly towards the target
         *     and stop when the target fills most of the canvas.&lt;/li&gt;
         *     &lt;li&gt;When the target is an explicit {{#crossLink &quot;Camera&quot;}}{{/crossLink}} position, given as &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60;
         *      vectors, then this CameraFlight will interpolate the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to that target and stop there.&lt;/li&gt;
         * @method flyTo
         * @param params  {*|Component} Either a parameters object or a {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that has a {{#crossLink &quot;WorldBoundary&quot;}}{{/crossLink}}.
         * @param[params.arc=0]  {Number} Factor in range [0..1] indicating how much the
         * {{#crossLink &quot;Camera/eye:property&quot;}}Camera&#x27;s eye{{/crossLink}} position will
         * swing away from its {{#crossLink &quot;Camera/eye:property&quot;}}look{{/crossLink}} position as it flies to the target.
         * @param [params.component] {String|Component} ID or instance of a component to fly to.
         * @param [params.aabb] {*}  World-space axis-aligned bounding box (AABB) target to fly to.
         * @param [params.eye] {Array of Number} Position to fly the eye position to.
         * @param [params.look] {Array of Number} Position to fly the look position to.
         * @param [params.up] {Array of Number} Position to fly the up vector to.
         * @param [params.stopFOV] {Number} How much of field-of-view, in degrees, that a target AABB should fill the canvas.
         * @param [callback] {Function} Callback fired on arrival
         * @param [scope] {Object} Optional scope for callback
         */
        flyTo: function (params, callback, scope) {

            if (this._flying) {
                this.stop();
            }

            var camera = this._attached.camera;

            if (!camera) {
                if (callback) {
                    if (scope) {
                        callback.call(scope);
                    } else {
                        callback();
                    }
                }
                return;
            }

            this._flying = false;

            this._callback = callback;
            this._callbackScope = scope;

            var lookat = camera.view;

            this._eye1[0] = lookat.eye[0];
            this._eye1[1] = lookat.eye[1];
            this._eye1[2] = lookat.eye[2];

            this._look1[0] = lookat.look[0];
            this._look1[1] = lookat.look[1];
            this._look1[2] = lookat.look[2];

            this._up1[0] = lookat.up[0];
            this._up1[1] = lookat.up[1];
            this._up1[2] = lookat.up[2];

            var aabb;
            var eye;
            var look;
            var up;
            var componentId;

            if (params.worldBoundary) {

                // Argument is a Component subtype with a worldBoundary

                aabb = params.worldBoundary.aabb;

            } else if (params.aabb) {

                aabb = params.aabb;

                // Argument is a Boundary3D

            } else if (params.min !== undefined &amp;&amp; params.max !== undefined) {

                // Argument is an AABB

                aabb = params;

            } else if (params.eye || params.look || params.up) {

                // Argument is eye, look and up positions

                eye = params.eye;
                look = params.look;
                up = params.up;

            } else {

                // Argument must be an instance or ID of a Component (subtype)

                var component = params;

                if (XEO._isNumeric(component) || XEO._isString(component)) {

                    componentId = component;

                    component = this.scene.components[componentId];

                    if (!component) {
                        this.error(&quot;Component not found: &quot; + XEO._inQuotes(componentId));
                        if (callback) {
                            if (scope) {
                                callback.call(scope);
                            } else {
                                callback();
                            }
                        }
                        return;
                    }
                }

                var worldBoundary = component.worldBoundary;

                if (!worldBoundary) {
                    this.error(&quot;Can&#x27;t fly to component &quot; + XEO._inQuotes(componentId) + &quot; - does not have a worldBoundary&quot;);
                    if (callback) {
                        if (scope) {
                            callback.call(scope);
                        } else {
                            callback();
                        }
                    }
                    return;
                }

                aabb = worldBoundary.aabb;
            }

            var offset = params.offset;

            if (aabb) {

                if (aabb.max[0] &lt;= aabb.min[0] || aabb.max[1] &lt;= aabb.min[1] || aabb.max[2] &lt;= aabb.min[2]) {

                    // Don&#x27;t fly to an empty boundary
                    return;
                }

                // Show boundary

                this._boundaryIndicator.geometry.aabb = aabb;
                this._boundaryIndicator.visibility.visible = true;

                var aabbCenter = XEO.math.getAABBCenter(aabb);

                this._look2 = params.look || aabbCenter;

                if (offset) {
                    this._look2[0] += offset[0];
                    this._look2[1] += offset[1];
                    this._look2[2] += offset[2];
                }

                var vec = XEO.math.normalizeVec3(XEO.math.subVec3(this._eye1, this._look1, tempVec3));
                var diag = (params.look &amp;&amp; false) ? XEO.math.getAABBDiagPoint(aabb, params.look) : XEO.math.getAABBDiag(aabb);
                var sca = Math.abs((diag) / Math.tan((params.stopFOV || this._stopFOV) / 2));

                this._eye2[0] = this._look2[0] + (vec[0] * sca);
                this._eye2[1] = this._look2[1] + (vec[1] * sca);
                this._eye2[2] = this._look2[2] + (vec[2] * sca);

                this._up2[0] = this._up1[0];
                this._up2[1] = this._up1[1];
                this._up2[2] = this._up1[2];

            } else if (eye || look || up) {

                look = look || this._look1;
                eye = eye || this._eye1;
                up = up || this._up1;

                this._look2[0] = look[0];
                this._look2[1] = look[1];
                this._look2[2] = look[2];

                this._eye2[0] = eye[0];
                this._eye2[1] = eye[1];
                this._eye2[2] = eye[2];

                this._up2[0] = up[0];
                this._up2[1] = up[1];
                this._up2[2] = up[2];
            }

            this.fire(&quot;started&quot;, params, true);

            this._time1 = Date.now();
            this._time2 = this._time1 + (params.duration ? params.duration * 1000 : this._duration);

            this._flying = true; // False as soon as we stop

            XEO.scheduleTask(this._update, this);
        },

        /**
         * Jumps this CameraFlight&#x27;s {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to the given target.
         *
         * &lt;ul&gt;
         *     &lt;li&gt;When the target is a boundary, this CameraFlight will position the {{#crossLink &quot;Camera&quot;}}{{/crossLink}}
         *     at where the target fills most of the canvas.&lt;/li&gt;
         *     &lt;li&gt;When the target is an explicit {{#crossLink &quot;Camera&quot;}}{{/crossLink}} position, given as &#x60;&#x60;&#x60;&#x60;eye&#x60;&#x60;&#x60;&#x60;, &#x60;&#x60;&#x60;&#x60;look&#x60;&#x60;&#x60;&#x60; and &#x60;&#x60;&#x60;&#x60;up&#x60;&#x60;&#x60;&#x60;
         *      vectors, then this CameraFlight will jump the {{#crossLink &quot;Camera&quot;}}{{/crossLink}} to that target.&lt;/li&gt;
         * @method flyTo
         * @param params  {*|Component} Either a parameters object or a {{#crossLink &quot;Component&quot;}}{{/crossLink}} subtype that has a {{#crossLink &quot;WorldBoundary&quot;}}{{/crossLink}}.
         * @param[params.arc=0]  {Number} Factor in range [0..1] indicating how much the
         * {{#crossLink &quot;Camera/eye:property&quot;}}Camera&#x27;s eye{{/crossLink}} position will
         * swing away from its {{#crossLink &quot;Camera/eye:property&quot;}}look{{/crossLink}} position as it flies to the target.
         * @param [params.component] {String|Component} ID or instance of a component to fly to.
         * @param [params.aabb] {*}  World-space axis-aligned bounding box (AABB) target to fly to.
         * @param [params.eye] {Array of Number} Position to fly the eye position to.
         * @param [params.look] {Array of Number} Position to fly the look position to.
         * @param [params.up] {Array of Number} Position to fly the up vector to.
         * @param [params.stopFOV] {Number} How much of field-of-view, in degrees, that a target AABB should fill the canvas.
         */
        jumpTo: function (params) {

            if (this._flying) {
                this.stop();
            }

            var camera = this._attached.camera;

            if (!camera) {
                return;
            }

            var lookat = camera.view;

            var aabb;
            var eye;
            var look;
            var up;
            var componentId;

            if (params.worldBoundary) {

                // Argument is a Component subtype with a worldBoundary

                aabb = params.worldBoundary.aabb;

            } else if (params.aabb) {

                aabb = params.aabb;

                // Argument is a Boundary3D

            } else if (params.min !== undefined &amp;&amp; params.max !== undefined) {

                // Argument is an AABB

                aabb = params;

            } else if (params.eye || params.look || params.up) {

                // Argument is eye, look and up positions

                eye = params.eye;
                look = params.look;
                up = params.up;

            } else {

                // Argument must be an instance or ID of a Component (subtype)

                var component = params;

                if (XEO._isNumeric(component) || XEO._isString(component)) {

                    componentId = component;

                    component = this.scene.components[componentId];

                    if (!component) {
                        this.error(&quot;Component not found: &quot; + XEO._inQuotes(componentId));
                        return;
                    }
                }

                var worldBoundary = component.worldBoundary;

                if (!worldBoundary) {
                    this.error(&quot;Can&#x27;t jump to component &quot; + XEO._inQuotes(componentId) + &quot; - does not have a worldBoundary&quot;);
                    return;
                }

                aabb = worldBoundary.aabb;
            }

            var offset = params.offset;

            if (aabb) {

                if (aabb.max[0] &lt;= aabb.min[0] || aabb.max[1] &lt;= aabb.min[1] || aabb.max[2] &lt;= aabb.min[2]) {

                    // Don&#x27;t fly to an empty boundary
                    return;
                }

                eye = lookat.eye;
                look = XEO.math.getAABBCenter(aabb);

                var vec = XEO.math.normalizeVec3(XEO.math.subVec3(eye, look, tempVec3));
                var diag = XEO.math.getAABBDiag(aabb);
                var sca = Math.abs((diag) / Math.tan((params.stopFOV || this._stopFOV) / 2));

                lookat.eye = [look[0] + (vec[0] * sca), look[1] + (vec[1] * sca), look[2] + (vec[2] * sca)];
                lookat.look = look;

            } else if (eye || look || up) {

                if (eye) {
                    lookat.eye = eye;
                }

                if (look) {
                    lookat.look = look;
                }

                if (up) {
                    lookat.up = up;
                }
            }
        },

        _update: function () {

            if (!this._flying) {
                return;
            }

            var time = Date.now();

            var t = (time - this._time1) / (this._time2 - this._time1);

            var stopping = (t &gt;= 1);

            if (t &gt; 1) {
                t = 1;
            }

            t = this.easing ? this._ease(t, 0, 1, 1) : t;

            var view = this._attached.camera.view;

            view.eye = XEO.math.lerpVec3(t, 0, 1, this._eye1, this._eye2, tempVec3);
            view.look = XEO.math.lerpVec3(t, 0, 1, this._look1, this._look2, tempVec3b);
            view.up = XEO.math.lerpVec3(t, 0, 1, this._up1, this._up2, tempVec3c);

            if (stopping) {
                this.stop();
                return;
            }

            XEO.scheduleTask(this._update, this); // Keep flying
        },

        // Quadratic easing out - decelerating to zero velocity
        // http://gizma.com/easing

        _ease: function (t, b, c, d) {
            t /= d;
            return -c * t * (t - 2) + b;
        },

        /**
         * Stops an earlier flyTo, fires arrival callback.
         * @method stop
         */
        stop: function () {

            if (!this._flying) {
                return;
            }

            this._boundaryIndicator.visibility.visible = false;

            this._flying = false;

            this._time1 = null;
            this._time2 = null;

            var callback = this._callback;

            if (callback) {

                this._callback = null;

                if (this._callbackScope) {
                    callback.call(this._callbackScope);
                } else {
                    callback();
                }
            }

            this.fire(&quot;stopped&quot;, true, true);
        },

        /**
         * Cancels an earlier flyTo without calling the arrival callback.
         * @method cancel
         */
        cancel: function () {

            if (!this._flying) {
                return;
            }

            this._boundaryIndicator.visibility.visible = false;

            this._flying = false;

            this._time1 = null;
            this._time2 = null;

            if (this._callback) {
                this._callback = null;
            }

            this.fire(&quot;canceled&quot;, true, true);
        },

        _props: {

            camera: {

                set: function (value) {

                    /**
                     * Fired whenever this CameraFlight&#x27;s {{#crossLink &quot;CameraFlight/camera:property&quot;}}{{/crossLink}}
                     * property changes.
                     *
                     * @event camera
                     * @param value The property&#x27;s new value
                     */
                    this._attach({
                        name: &quot;camera&quot;,
                        type: &quot;XEO.Camera&quot;,
                        component: value,
                        sceneDefault: true
                    });

                    this.stop();
                },

                get: function () {
                    return this._attached.camera;
                }
            },

            duration: {

                set: function (value) {

                    this._duration = value * 1000.0;

                    this.stop();
                },

                get: function () {
                    return this._duration / 1000.0;
                }
            }
        },

        _getJSON: function () {

            var json = {};

            if (this._attached.camera) {
                json.camera = this._attached.camera.id;
            }

            return json;
        },

        _destroy: function () {
            this.stop();
        }
    });

})();

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
